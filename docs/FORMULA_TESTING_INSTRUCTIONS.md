# üß™ Formula Engine Testing Instructions

**Date:** October 5, 2025  
**Version:** Debug v0.7.0

---

## üìã –¶–µ–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–í—ã—è—Å–Ω–∏—Ç—å –ø–æ—á–µ–º—É `=SUM(A1:B1)` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `0` –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—É–º–º—ã.

---

## üîß –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: –° –ü–û–î–†–û–ë–ù–´–ú–ò –õ–û–ì–ê–ú–ò

–í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã **–¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏** –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

### –õ–æ–≥–∏ –≤ setCellValue:
```
üíæ setCellValue called:
   Position: row=X, col=Y, sheet=...
   Value: "..."
   Cell key: "X-Y"
   ‚Üí Saving as VALUE/FORMULA
```

### –õ–æ–≥–∏ –≤ syncSheetToHyperFormula:
```
üîÑ Starting HyperFormula sync...
  Sheet: ... ID: ...
  Total cells: N
  üìù Cell X-Y (row=X, col=Y):
     value: ...
     type: ...
     formula: ...
     ‚Üí Setting VALUE/FORMULA: ...
‚úÖ HyperFormula synced: N cells
```

### –õ–æ–≥–∏ –≤ getCellDisplayValue (—Ñ–æ—Ä–º—É–ª—ã):
```
üßÆ Evaluating formula at row=X, col=Y
   Formula: =...
   Address: { sheet: 0, col: Y, row: X }
   Result from HyperFormula: ... (type: ...)
   ‚úÖ Final result: ...
```

---

## üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

1. Dev —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ `http://localhost:1420`
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ Chrome/Edge/Firefox
3. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Console**

### –®–∞–≥ 2: –í—ã–ø–æ–ª–Ω–∏—Ç–µ –±–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç

**–¢–µ—Å—Ç: `=SUM(A1:B1)` –≥–¥–µ A1=5, B1=3**

1. **–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —è—á–µ–π–∫—É A1**
   - –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:
     ```
     (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
     ```

2. **–í–≤–µ–¥–∏—Ç–µ `5` –≤ A1 –∏ –Ω–∞–∂–º–∏—Ç–µ Enter**
   - –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:
     ```
     üíæ setCellValue called:
        Position: row=1, col=1, sheet=...
        Value: "5"
        Cell key: "1-1"
        ‚Üí Saving as VALUE:
           type: n
           value: 5 (number)
     ```
   
3. **–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —è—á–µ–π–∫—É B1**

4. **–í–≤–µ–¥–∏—Ç–µ `3` –≤ B1 –∏ –Ω–∞–∂–º–∏—Ç–µ Enter**
   - –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:
     ```
     üíæ setCellValue called:
        Position: row=1, col=2, sheet=...
        Value: "3"
        Cell key: "1-2"
        ‚Üí Saving as VALUE:
           type: n
           value: 3 (number)
     ```

5. **–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —è—á–µ–π–∫—É C1**

6. **–í–≤–µ–¥–∏—Ç–µ `=SUM(A1:B1)` –∏ –Ω–∞–∂–º–∏—Ç–µ Enter**
   - –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:
     ```
     üíæ setCellValue called:
        Position: row=1, col=3, sheet=...
        Value: "=SUM(A1:B1)"
        Cell key: "1-3"
        ‚Üí Saving as FORMULA:
           formula: "SUM(A1:B1)"
           value: "=SUM(A1:B1)"
     
     üßÆ Evaluating formula at row=1, col=3
        Formula: =SUM(A1:B1)
     
     üîÑ Starting HyperFormula sync...
       Sheet: ... ID: ...
       Total cells: 3
       üìù Cell 1-1 (row=1, col=1):
          value: 5
          type: n
          formula: undefined
          ‚Üí Setting VALUE: 5 (number)
       üìù Cell 1-2 (row=1, col=2):
          value: 3
          type: n
          formula: undefined
          ‚Üí Setting VALUE: 3 (number)
       üìù Cell 1-3 (row=1, col=3):
          value: =SUM(A1:B1)
          type: str
          formula: SUM(A1:B1)
          ‚Üí Setting FORMULA: "=SUM(A1:B1)"
     ‚úÖ HyperFormula synced: 3 cells
     
        Address: { sheet: 0, col: 3, row: 1 }
        Result from HyperFormula: ??? (type: ???)
        ‚úÖ Final result: ???
     ```

### –®–∞–≥ 3: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –í–û–ü–†–û–°–´:**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é:**
   - –Ø—á–µ–π–∫–∞ A1 –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å `row=1, col=1` –ò–õ–ò `row=0, col=0`?
   - –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ª–æ–≥–∏?

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é:**
   - –í—Å–µ –ª–∏ 3 —è—á–µ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å?
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –±—ã–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ HyperFormula?

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç HyperFormula:**
   - –ß—Ç–æ –≤–µ—Ä–Ω—É–ª `hf.getCellValue()`?
   - –ï—Å–ª–∏ 0 ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ HyperFormula API
   - –ï—Å–ª–∏ null/undefined ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∞–¥—Ä–µ—Å–∞—Ü–∏–∏
   - –ï—Å–ª–∏ error object ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ñ–æ—Ä–º—É–ª–µ

---

## üîç –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö

### ‚úÖ –•–æ—Ä–æ—à–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:
- `‚Üí Setting VALUE: 5 (number)` - —á–∏—Å–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è
- `‚Üí Setting FORMULA: "=SUM(A1:B1)"` - —Ñ–æ—Ä–º—É–ª–∞ —Å "="
- `Result from HyperFormula: 8 (type: number)` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### ‚ùå –ü–ª–æ—Ö–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:
- `‚Üí Setting VALUE: "5" (string)` - —á–∏—Å–ª–∞ –æ—Å—Ç–∞–ª–∏—Å—å —Å—Ç—Ä–æ–∫–∞–º–∏
- `Row=0, col=0` –¥–ª—è —è—á–µ–π–∫–∏ A1 - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
- `Result from HyperFormula: 0` - HyperFormula –Ω–µ –≤–∏–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ
- `Result from HyperFormula: null` - –∞–¥—Ä–µ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- `Result from HyperFormula: { type: 'ERROR', ... }` - –æ—à–∏–±–∫–∞ –≤ —Ñ–æ—Ä–º—É–ª–µ

---

## üìä –ó–∞–ø–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω: [–î–∞—Ç–∞/–í—Ä–µ–º—è]

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ —è—á–µ–π–∫–µ C1:** ___________

**–õ–æ–≥–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏:**
```
[–í—Å—Ç–∞–≤–∏—Ç—å —Å—é–¥–∞ –ø–æ–ª–Ω—ã–µ –ª–æ–≥–∏]
```

**–ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
1. 
2. 
3. 

**–ì–∏–ø–æ—Ç–µ–∑—ã:**
1. 
2. 
3. 

---

## üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç 2: –ü—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º—É–ª–∞ A1+B1
```
A1 = 5
B1 = 3
C1 = =A1+B1
–û–∂–∏–¥–∞–µ—Ç—Å—è: 8
```

### –¢–µ—Å—Ç 3: –§—É–Ω–∫—Ü–∏—è AVERAGE
```
A1 = 10
A2 = 20
A3 = 30
A4 = =AVERAGE(A1:A3)
–û–∂–∏–¥–∞–µ—Ç—Å—è: 20
```

### –¢–µ—Å—Ç 4: IF —Ñ—É–Ω–∫—Ü–∏—è
```
A1 = 10
B1 = =IF(A1>5, "Yes", "No")
–û–∂–∏–¥–∞–µ—Ç—Å—è: "Yes"
```

---

## üîß –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ –≤ `FORMULA_ENGINE_INVESTIGATION.md`
2. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—Ö–æ–¥–∫–∏
3. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å root cause
4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
5. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç
6. –£–±—Ä–∞—Ç—å debug –ª–æ–≥–∏ –∏–∑ production

---

**Status:** üü° Awaiting Test Results  
**Priority:** üî• Critical
